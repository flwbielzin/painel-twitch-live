<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="panel-title">Painel de Controle - Carregando...</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(145, 70, 255, 0.1);
            border-radius: 15px;
            border: 2px solid #9146ff;
        }

        .header h1 {
            color: #9146ff;
            margin-bottom: 10px;
        }

        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .status.online {
            background: #00ff88;
            color: black;
        }

        .status.offline {
            background: #ff6b6b;
            color: white;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(145, 70, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .card h3 {
            color: #9146ff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            color: #ccc;
        }

        .metric-value {
            font-weight: bold;
            font-size: 18px;
        }

        .metric-value.viewers { color: #00ff88; }
        .metric-value.followers { color: #ff6b6b; }
        .metric-value.subscribers { color: #ffd700; }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        button {
            background: #9146ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #7c3aed;
            transform: translateY(-2px);
        }

        button.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #9146ff;
        }

        button.secondary:hover {
            background: rgba(145, 70, 255, 0.2);
        }

        .input-group {
            margin: 10px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
            font-size: 14px;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid rgba(145, 70, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 14px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #9146ff;
        }

        .log {
            background: #000;
            color: #00ff88;
            padding: 15px;
            border-radius: 8px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin-top: 15px;
        }

        .overlay-preview {
            text-align: center;
            padding: 20px;
        }

        .overlay-link {
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid #00ff88;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            word-break: break-all;
        }

        .overlay-link a {
            color: #00ff88;
            text-decoration: none;
            font-weight: bold;
        }

        .overlay-link a:hover {
            text-decoration: underline;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #666;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-card {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(145, 70, 255, 0.3);
        }

        .stat-icon {
            font-size: 24px;
            margin-right: 10px;
        }

        .stat-info {
            text-align: left;
        }

        .stat-label {
            color: #ccc;
            font-size: 14px;
        }

        .stat-value {
            font-weight: bold;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 id="panel-header">ğŸ® Painel de Controle - Carregando...</h1>
            <p>Gerencie seu overlay mobile para lives IRL</p>
            <div class="status offline" id="api-status">ğŸ”´ Desconectado</div>
        </div>

        <!-- Grid Principal -->
        <div class="grid">
            <!-- Status da Stream -->
            <div class="card">
                <h3>ğŸ”´ Status da Stream</h3>
                <div class="metric">
                    <span class="metric-label">ğŸ“¡ Status</span>
                    <span class="metric-value" id="stream-status">Offline</span>
                </div>
                <div class="metric">
                    <span class="metric-label">ğŸ® Categoria</span>
                    <span class="metric-value" id="stream-category">-</span>
                </div>
                <div class="metric">
                    <span class="metric-label">ğŸ“ TÃ­tulo</span>
                    <span class="metric-value" id="current-title">-</span>
                </div>
                <div class="metric">
                    <span class="metric-label">â° Tempo de Stream</span>
                    <span class="metric-value" id="stream-uptime">00:00:00</span>
                </div>
                <div class="controls">
                    <button onclick="atualizarDados()">ğŸ”„ Atualizar</button>
                    <button class="secondary" onclick="testarAPI()">ğŸ§ª Testar API</button>
                </div>
            </div>

            <!-- MÃ©tricas em Tempo Real -->
            <div class="card">
                <h3>ğŸ“Š MÃ©tricas em Tempo Real</h3>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ‘¥</div>
                    <div class="stat-info">
                        <div class="stat-label">Viewers</div>
                        <div class="stat-value" id="viewers-count">0</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">â¤ï¸</div>
                    <div class="stat-info">
                        <div class="stat-label">Seguidores</div>
                        <div class="stat-value" id="followers-count">0</div>
                    </div>
                </div>
                
                <div class="metric">
                    <span class="metric-label">ğŸ“ˆ Pico de Viewers</span>
                    <span class="metric-value" id="peak-viewers">0</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">â­ Qualidade</span>
                    <span class="metric-value" id="stream-quality">-</span>
                </div>
            </div>

            <!-- Controle da Meta de Seguidores -->
            <div class="card">
                <h3>ğŸ¯ Meta de Seguidores Mobile</h3>
                
                <!-- Status Atual da Meta -->
                <div class="metric">
                    <span class="metric-label">ğŸ“Š Meta Atual</span>
                    <span class="metric-value" id="current-goal-display">1,247 / 1,500</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">ğŸ“ˆ Progresso</span>
                    <span class="metric-value" id="goal-progress-display">83.1%</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">ğŸ¯ Faltam</span>
                    <span class="metric-value" id="goal-remaining-display">253 seguidores</span>
                </div>
                
                <!-- Controles para Editar Meta -->
                <div class="input-group">
                    <label>ğŸ‘¥ Seguidores Atuais</label>
                    <input type="number" id="current-followers-input" placeholder="1247" min="0">
                </div>
                
                <div class="input-group">
                    <label>ğŸ¯ Nova Meta de Seguidores</label>
                    <input type="number" id="target-followers-input" placeholder="1500" min="1">
                </div>
                
                <div class="controls">
                    <button onclick="atualizarMetaSeguidores()">ğŸ¯ Atualizar Meta</button>
                    <button class="secondary" onclick="simularNovoSeguidor()">ğŸ‰ Simular Seguidor</button>
                    <button class="secondary" onclick="resetarMeta()">ğŸ”„ Reset Meta</button>
                </div>
                
                <!-- Preview da Meta -->
                <div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                    <h5 style="color: #9146ff; margin-bottom: 10px;">ğŸ“± Preview Mobile:</h5>
                    <div style="font-size: 12px; color: #ccc;">
                        <p>âœ… As alteraÃ§Ãµes serÃ£o aplicadas automaticamente no overlay mobile</p>
                        <p>âœ… NotificaÃ§Ãµes de novos seguidores aparecerÃ£o em tempo real</p>
                        <p>âœ… Barra de progresso serÃ¡ atualizada instantaneamente</p>
                    </div>
                </div>
                
                <!-- HistÃ³rico de AlteraÃ§Ãµes -->
                <div style="margin-top: 15px;">
                    <h5 style="color: #9146ff; margin-bottom: 10px;">ğŸ“‹ Ãšltimas AlteraÃ§Ãµes:</h5>
                    <div id="goal-history" style="max-height: 100px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px; font-size: 12px;">
                        <p style="color: #666; text-align: center;">Nenhuma alteraÃ§Ã£o ainda</p>
                    </div>
                </div>
            </div>

            <!-- Controles da Stream -->
            <div class="card">
                <h3>ğŸ›ï¸ Controles da Stream</h3>
                <div class="input-group">
                    <label>ğŸ“ Alterar TÃ­tulo</label>
                    <input type="text" id="new-title" placeholder="Digite o novo tÃ­tulo...">
                    <button onclick="alterarTitulo()" style="margin-top: 5px;">âœï¸ Alterar TÃ­tulo</button>
                </div>
                
                <div class="input-group">
                    <label>ğŸ® Alterar Categoria/Jogo</label>
                    <input type="text" id="new-category" placeholder="Digite a categoria...">
                    <button onclick="alterarCategoria()" style="margin-top: 5px;">ğŸ¯ Alterar Categoria</button>
                </div>
                
                <div class="input-group">
                    <label>ğŸ·ï¸ Tags da Stream</label>
                    <input type="text" id="stream-tags" placeholder="IRL, PortuguÃªs, Interativo...">
                    <button onclick="alterarTags()" style="margin-top: 5px;">ğŸ·ï¸ Alterar Tags</button>
                </div>
            </div>

            <!-- CriaÃ§Ã£o de Clips -->
            <div class="card">
                <h3>ğŸ¬ Gerador de Clips AvanÃ§ado</h3>
                <div class="metric">
                    <span class="metric-label">ğŸ“¹ Clips Criados Hoje</span>
                    <span class="metric-value" id="clips-count">0</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">ğŸ¤– Status do Auto-Clip</span>
                    <span class="metric-value" id="auto-clip-status">Aguardando...</span>
                </div>
                
                <div class="input-group">
                    <label>ğŸ“ TÃ­tulo do Clip (opcional)</label>
                    <input type="text" id="clip-title" placeholder="Momento Ã©pico!">
                </div>
                
                <div class="controls">
                    <button onclick="criarClip()">ğŸ¬ Criar Clip Manual</button>
                    <button class="secondary" onclick="verClips()">ğŸ“‹ Ver Clips</button>
                    <button class="secondary" onclick="toggleAutoClips()">ğŸ¤– Toggle Auto-Clips</button>
                </div>
                
                <!-- ConfiguraÃ§Ãµes de Auto-Clips -->
                <div class="input-group" style="margin-top: 15px;">
                    <label>âš™ï¸ ConfiguraÃ§Ãµes de Auto-Clips</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                        <label style="font-size: 12px;">
                            <input type="checkbox" id="auto-followers" checked>
                            ğŸ“ˆ Novos Seguidores (+5)
                        </label>
                        <label style="font-size: 12px;">
                            <input type="checkbox" id="auto-viewers" checked>
                            ğŸ‘¥ Pico de Viewers (+50)
                        </label>
                        <label style="font-size: 12px;">
                            <input type="checkbox" id="auto-chat" checked>
                            ğŸ’¬ Chat Muito Ativo
                        </label>
                        <label style="font-size: 12px;">
                            <input type="checkbox" id="manual-clips" checked>
                            âœ‹ Clips Manuais
                        </label>
                    </div>
                </div>
                
                <!-- HistÃ³rico de Clips Recentes -->
                <div style="margin-top: 15px;">
                    <h5 style="color: #9146ff; margin-bottom: 10px;">ğŸ“‹ Clips Recentes:</h5>
                    <div id="clips-history" style="max-height: 120px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px;">
                        <p style="color: #666; font-size: 12px; text-align: center;">Nenhum clip criado ainda</p>
                    </div>
                </div>
                
                <div id="ultimo-clip" style="margin-top: 10px; display: none;">
                    <p style="color: #00ff88;">âœ… Ãšltimo clip criado:</p>
                    <a id="clip-link" href="#" target="_blank" style="color: #9146ff;">Ver Clip</a>
                </div>
            </div>

            <!-- Analytics AvanÃ§ados -->
            <div class="card">
                <h3>ğŸ“ˆ Analytics da Stream</h3>
                <div class="metric">
                    <span class="metric-label">ğŸ‘¥ MÃ©dia de Viewers</span>
                    <span class="metric-value" id="avg-viewers">0</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">â±ï¸ Tempo MÃ©dio de VisualizaÃ§Ã£o</span>
                    <span class="metric-value" id="avg-watch-time">0min</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">ğŸ†• Novos Seguidores Hoje</span>
                    <span class="metric-value" id="new-followers">0</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">ğŸ’¬ Mensagens no Chat</span>
                    <span class="metric-value" id="chat-messages">0</span>
                </div>
                
                <div class="controls">
                    <button onclick="exportarAnalytics()">ğŸ“Š Exportar Dados</button>
                </div>
            </div>

            <!-- ModeraÃ§Ã£o e Chat -->
            <div class="card">
                <h3>ğŸ›¡ï¸ ModeraÃ§Ã£o</h3>
                <div class="input-group">
                    <label>ğŸ’¬ Enviar Mensagem no Chat</label>
                    <input type="text" id="chat-message" placeholder="Digite sua mensagem...">
                    <button onclick="enviarMensagem()" style="margin-top: 5px;">ğŸ“¤ Enviar</button>
                </div>
                
                <div class="input-group">
                    <label>â° Modo Lento (segundos)</label>
                    <select id="slow-mode">
                        <option value="0">Desativado</option>
                        <option value="3">3 segundos</option>
                        <option value="5">5 segundos</option>
                        <option value="10">10 segundos</option>
                        <option value="30">30 segundos</option>
                    </select>
                    <button onclick="alterarModoLento()" style="margin-top: 5px;">â° Aplicar</button>
                </div>
                
                <div class="controls">
                    <button onclick="limparChat()">ğŸ§¹ Limpar Chat</button>
                    <button class="secondary" onclick="modoSeguidor()">ğŸ‘¥ Modo Seguidor</button>
                </div>
            </div>

            <!-- ğŸ‘¥ COMUNIDADE -->
            <div class="card">
                <h3>ğŸ‘¥ Comunidade</h3>
                
                <!-- Chatters Ativos -->
                <div class="metric">
                    <span class="metric-label">ğŸ’¬ Chatters Ativos</span>
                    <span class="metric-value" id="chatters-count">0</span>
                </div>
                
                <!-- Lista de Chatters -->
                <div style="margin: 10px 0;">
                    <h5 style="color: #9146ff; margin-bottom: 10px;">ğŸ‘¥ UsuÃ¡rios no Chat:</h5>
                    <div id="chatters-list" style="max-height: 100px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px; font-size: 12px;">
                        <p style="color: #666; text-align: center;">Carregando...</p>
                    </div>
                </div>
                
                <!-- Emotes do Canal -->
                <div class="metric">
                    <span class="metric-label">ğŸ­ Emotes do Canal</span>
                    <span class="metric-value" id="emotes-count">0</span>
                </div>
                
                <!-- Moderadores -->
                <div class="metric">
                    <span class="metric-label">ğŸ›¡ï¸ Moderadores</span>
                    <span class="metric-value" id="moderators-count">0</span>
                </div>
                
                <!-- VIPs -->
                <div class="metric">
                    <span class="metric-label">â­ VIPs</span>
                    <span class="metric-value" id="vips-count">0</span>
                </div>
                
                <div class="controls">
                    <button onclick="atualizarComunidade()">ğŸ”„ Atualizar</button>
                    <button class="secondary" onclick="verEmotes()">ğŸ­ Ver Emotes</button>
                    <button class="secondary" onclick="gerenciarMods()">ğŸ›¡ï¸ Moderadores</button>
                </div>
            </div>

            <!-- ğŸ’° MONETIZAÃ‡ÃƒO -->
            <div class="card">
                <h3>ğŸ’° MonetizaÃ§Ã£o</h3>
                
                <!-- Subscribers -->
                <div class="metric">
                    <span class="metric-label">ğŸ’ Subscribers</span>
                    <span class="metric-value" id="subscribers-count">0</span>
                </div>
                
                <!-- Channel Points -->
                <div class="metric">
                    <span class="metric-label">ğŸ Recompensas Ativas</span>
                    <span class="metric-value" id="rewards-count">0</span>
                </div>
                
                <!-- Recompensas Personalizadas -->
                <div style="margin: 10px 0;">
                    <h5 style="color: #9146ff; margin-bottom: 10px;">ğŸ Channel Points:</h5>
                    <div id="rewards-list" style="max-height: 120px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px; font-size: 12px;">
                        <p style="color: #666; text-align: center;">Carregando recompensas...</p>
                    </div>
                </div>
                
                <!-- Criar Nova Recompensa -->
                <div class="input-group">
                    <label>ğŸ Criar Recompensa</label>
                    <input type="text" id="reward-title" placeholder="Nome da recompensa...">
                    <input type="number" id="reward-cost" placeholder="Custo em pontos..." style="margin-top: 5px;">
                    <button onclick="criarRecompensa()" style="margin-top: 5px;">âœ¨ Criar</button>
                </div>
                
                <div class="controls">
                    <button onclick="atualizarMonetizacao()">ğŸ”„ Atualizar</button>
                    <button class="secondary" onclick="verSubscribers()">ğŸ’ Ver Subs</button>
                    <button class="secondary" onclick="gerenciarRecompensas()">ğŸ Gerenciar</button>
                </div>
            </div>

            <!-- ğŸ“º GESTÃƒO DE CONTEÃšDO -->
            <div class="card">
                <h3>ğŸ“º GestÃ£o de ConteÃºdo</h3>
                
                <!-- VODs -->
                <div class="metric">
                    <span class="metric-label">ğŸ“¹ VODs DisponÃ­veis</span>
                    <span class="metric-value" id="vods-count">0</span>
                </div>
                
                <!-- Marcadores -->
                <div class="metric">
                    <span class="metric-label">ğŸ“ Marcadores Criados</span>
                    <span class="metric-value" id="markers-count">0</span>
                </div>
                
                <!-- Criar Marcador -->
                <div class="input-group">
                    <label>ğŸ“ Criar Marcador na Stream</label>
                    <input type="text" id="marker-description" placeholder="DescriÃ§Ã£o do momento...">
                    <button onclick="criarMarcador()" style="margin-top: 5px;">ğŸ“ Marcar Momento</button>
                </div>
                
                <!-- Cronograma -->
                <div style="margin: 10px 0;">
                    <h5 style="color: #9146ff; margin-bottom: 10px;">ğŸ“… PrÃ³ximas Streams:</h5>
                    <div id="schedule-list" style="max-height: 100px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px; font-size: 12px;">
                        <p style="color: #666; text-align: center;">Carregando cronograma...</p>
                    </div>
                </div>
                
                <!-- VODs Recentes -->
                <div style="margin: 10px 0;">
                    <h5 style="color: #9146ff; margin-bottom: 10px;">ğŸ“¹ VODs Recentes:</h5>
                    <div id="vods-list" style="max-height: 120px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px; font-size: 12px;">
                        <p style="color: #666; text-align: center;">Carregando VODs...</p>
                    </div>
                </div>
                
                <div class="controls">
                    <button onclick="atualizarConteudo()">ğŸ”„ Atualizar</button>
                    <button class="secondary" onclick="gerenciarVODs()">ğŸ“¹ Gerenciar VODs</button>
                    <button class="secondary" onclick="editarCronograma()">ğŸ“… Cronograma</button>
                </div>
            </div>
        </div>

        <!-- ConfiguraÃ§Ãµes AvanÃ§adas -->
        <div class="card">
            <h3>âš™ï¸ ConfiguraÃ§Ãµes AvanÃ§adas</h3>
            <div class="grid" style="grid-template-columns: 1fr 1fr;">
                <div>
                    <div class="input-group">
                        <label>ğŸ“º Nome do Canal</label>
                        <input type="text" id="channel-name" placeholder="Carregando..." readonly>
                    </div>
                    <div class="input-group">
                        <label>ğŸ”” NotificaÃ§Ãµes</label>
                        <select id="notifications">
                            <option value="all">Todas</option>
                            <option value="follows">Apenas Follows</option>
                            <option value="none">Nenhuma</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>ğŸ”„ Intervalo de AtualizaÃ§Ã£o</label>
                        <select id="update-interval">
                            <option value="10">10 segundos</option>
                            <option value="30">30 segundos</option>
                            <option value="60">1 minuto</option>
                        </select>
                    </div>
                </div>
                <div>
                    <div class="input-group">
                        <label>ğŸ¨ Tema do Overlay</label>
                        <select id="overlay-theme">
                            <option value="purple">Roxo (PadrÃ£o)</option>
                            <option value="green">Verde</option>
                            <option value="blue">Azul</option>
                            <option value="red">Vermelho</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>ğŸ“± Tamanho do Overlay</label>
                        <select id="overlay-size">
                            <option value="small">Pequeno</option>
                            <option value="medium">MÃ©dio</option>
                            <option value="large">Grande</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="controls">
                <button onclick="salvarConfiguracoes()">ğŸ’¾ Salvar ConfiguraÃ§Ãµes</button>
                <button class="secondary" onclick="resetarConfiguracoes()">ğŸ”„ Reset</button>
                <button class="secondary" onclick="exportarConfiguracoes()">ğŸ“¤ Exportar</button>
            </div>
        </div>

        <!-- Overlay -->
        <div class="card">
            <h3>ğŸ–¥ï¸ Overlay Mobile</h3>
            <div class="overlay-preview">
                <p>Use este link no OBS Mobile:</p>
                <div class="overlay-link">
                    <a href="https://overlaymobile.flwbielzinn.com.br/" target="_blank" id="overlay-url">overlay-mobile.html</a>
                </div>
                <div class="controls">
                    <button onclick="abrirOverlay()">ğŸš€ Abrir Overlay</button>
                    <button class="secondary" onclick="copiarLink()">ğŸ“‹ Copiar Link</button>
                </div>
            </div>
        </div>

        <!-- Log -->
        <div class="card">
            <h3>ğŸ“ Log do Sistema</h3>
            <div class="log" id="system-log">
                [Carregando...] Painel de controle iniciado
            </div>
            <div class="controls">
                <button class="secondary" onclick="limparLog()">ğŸ—‘ï¸ Limpar Log</button>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p id="footer-text">Stream Control v1.0 - Overlay Mobile para Lives IRL</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="twitchApi.js"></script>
    <script src="clipGenerator.js"></script>
    <script>
        // VariÃ¡veis globais
        let twitchAPI; // Declarar a variÃ¡vel da API
        let updateInterval;
        let streamStartTime = null;
        let peakViewers = 0;
        let totalViewers = 0;
        let viewerSamples = 0;
        let newFollowersToday = 0;
        let clipsCreatedToday = 0;
        let currentData = {
            viewers: 0,
            followers: 0,
            uptime: '00:00:00',
            isLive: false,
            title: '',
            category: '',
            quality: '',
            streamerName: 'Streamer'
        };

        // Capturar logs
        const originalLog = console.log;
        const originalError = console.error;
        
        function addToLog(message, type = 'info') {
            const log = document.getElementById('system-log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#00ff88' : '#ffffff';
            log.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            log.scrollTop = log.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLog(args.join(' '), 'info');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToLog(args.join(' '), 'error');
        };

        // FunÃ§Ãµes principais
        async function inicializarPainel() {
            addToLog('ğŸš€ Inicializando painel de controle avanÃ§ado...', 'info');
            
            // Carregar configuraÃ§Ãµes salvas
            carregarConfiguracoes();
            
            // Inicializar API e carregar dados
            let apiInicializada = false;
            if (await initializeTwitchAPI()) {
                addToLog('âœ… API da Twitch carregada', 'success');
                apiInicializada = await testarAPI();
            } else {
                addToLog('âŒ API da Twitch nÃ£o encontrada', 'error');
            }
            
            // Sempre carregar dados (API ou simulados)
            if (!apiInicializada) {
                addToLog('ğŸ­ Carregando dados simulados para demonstraÃ§Ã£o', 'info');
                const dadosSimulados = gerarDadosSimulados();
                currentData = {
                    viewers: dadosSimulados.viewer_count,
                    followers: dadosSimulados.follower_count,
                    isLive: true,
                    title: dadosSimulados.title,
                    category: dadosSimulados.game_name,
                    quality: 'Simulado',
                    streamerName: dadosSimulados.display_name
                };
                
                // Atualizar interface com dados simulados
                atualizarDisplay();
                
                // Atualizar tÃ­tulos da pÃ¡gina
                const pageTitle = document.getElementById('panel-title');
                const panelHeader = document.getElementById('panel-header');
                const channelNameInput = document.getElementById('channel-name');
                const footerText = document.getElementById('footer-text');
                
                if (pageTitle) {
                    pageTitle.textContent = `Painel ${currentData.streamerName} - AO VIVO`;
                }
                
                if (panelHeader) {
                    panelHeader.textContent = `ğŸ® Painel de Controle - ${currentData.streamerName}`;
                }
                
                if (channelNameInput) {
                    channelNameInput.value = dadosSimulados.login;
                }
                
                if (footerText) {
                    footerText.textContent = `${currentData.streamerName} Stream Control v1.0 - Overlay Mobile para Lives IRL`;
                }
                
                // Simular que a stream comeÃ§ou
                streamStartTime = new Date(dadosSimulados.started_at);
                peakViewers = currentData.viewers;
                totalViewers = currentData.viewers;
                viewerSamples = 1;
            }
            
            // Inicializar gerador de clips avanÃ§ado
            if (typeof clipGenerator !== 'undefined') {
                addToLog('ğŸ¬ Inicializando gerador de clips avanÃ§ado...', 'info');
                const clipInitialized = await clipGenerator.initialize();
                if (clipInitialized) {
                    addToLog('âœ… Gerador de clips ativado com triggers automÃ¡ticos!', 'success');
                } else {
                    addToLog('âš ï¸ Gerador de clips em modo manual', 'info');
                }
                
                // Configurar triggers dos auto-clips
                configurarTriggersAutoClip();
            }
            
            // Iniciar atualizaÃ§Ãµes automÃ¡ticas
            iniciarAtualizacoes();
            
            // Iniciar contador de uptime
            iniciarUptimeCounter();
            
            // Inicializar controle da meta de seguidores
            inicializarControleMeta();
            
            addToLog('âœ… Painel inicializado com sucesso!', 'success');
        }

        async function testarAPI() {
            const statusElement = document.getElementById('api-status');
            
            try {
                addToLog('ğŸ§ª Testando conexÃ£o com API...', 'info');
                
                if (typeof twitchAPI !== 'undefined') {
                    const connected = await twitchAPI.testConnection();
                    
                    if (connected) {
                        statusElement.textContent = 'ğŸŸ¢ Conectado';
                        statusElement.className = 'status online';
                        addToLog('âœ… API conectada com sucesso!', 'success');
                        await atualizarDados();
                        return true;
                    } else {
                        statusElement.textContent = 'ğŸ”´ Erro na API';
                        statusElement.className = 'status offline';
                        addToLog('âŒ Falha na conexÃ£o com API', 'error');
                        return false;
                    }
                } else {
                    statusElement.textContent = 'ğŸ”´ API nÃ£o encontrada';
                    statusElement.className = 'status offline';
                    addToLog('âŒ API da Twitch nÃ£o carregada', 'error');
                    return false;
                }
            } catch (error) {
                statusElement.textContent = 'ğŸ”´ Erro';
                statusElement.className = 'status offline';
                addToLog(`âŒ Erro no teste: ${error.message}`, 'error');
                return false;
            }
        }

        async function atualizarDados() {
            try {
                addToLog('ğŸ”„ Atualizando dados...', 'info');
                
                let channelInfo = null;
                
                // Tentar obter dados da API
                if (typeof twitchAPI !== 'undefined') {
                    channelInfo = await twitchAPI.getChannelInfo();
                }
                
                // Se nÃ£o conseguiu dados da API, usar simulados
                if (!channelInfo || !channelInfo.display_name) {
                    addToLog('âš ï¸ API nÃ£o retornou dados, usando simulaÃ§Ã£o', 'info');
                    channelInfo = gerarDadosSimulados();
                }
                
                // Atualizar dados atuais
                const wasLive = currentData.isLive;
                currentData = {
                    viewers: channelInfo.viewer_count || 0,
                    followers: channelInfo.follower_count || 0,
                    isLive: channelInfo.is_live !== undefined ? channelInfo.is_live : true,
                    title: channelInfo.title || 'Live IRL - Explorando a cidade!',
                    category: channelInfo.game_name || 'IRL',
                    quality: channelInfo.is_live ? 'Ao vivo' : 'Simulado',
                    streamerName: channelInfo.display_name || channelInfo.login || CONFIG.CHANNEL_NAME || 'Streamer'
                };
                
                // Atualizar tÃ­tulos da pÃ¡gina dinamicamente
                const pageTitle = document.getElementById('panel-title');
                const panelHeader = document.getElementById('panel-header');
                const channelNameInput = document.getElementById('channel-name');
                const footerText = document.getElementById('footer-text');
                
                if (pageTitle) {
                    const status = currentData.isLive ? 'AO VIVO' : 'OFFLINE';
                    pageTitle.textContent = `Painel ${currentData.streamerName} - ${status}`;
                }
                
                if (panelHeader) {
                    panelHeader.textContent = `ğŸ® Painel de Controle - ${currentData.streamerName}`;
                }
                
                if (channelNameInput) {
                    channelNameInput.value = channelInfo.login || channelInfo.display_name || CONFIG.CHANNEL_NAME || 'N/A';
                }
                
                if (footerText) {
                    footerText.textContent = `${currentData.streamerName} Stream Control v1.0 - Overlay Mobile para Lives IRL`;
                }
                
                // Se comeÃ§ou a fazer live agora
                if (currentData.isLive && !wasLive) {
                    streamStartTime = channelInfo.started_at ? new Date(channelInfo.started_at) : new Date();
                    peakViewers = currentData.viewers;
                    totalViewers = currentData.viewers;
                    viewerSamples = 1;
                    addToLog('ğŸ”´ Stream iniciada!', 'success');
                    
                    // Ativar gerador de clips se stream comeÃ§ou
                    if (typeof clipGenerator !== 'undefined' && !clipGenerator.isEnabled) {
                        await clipGenerator.initialize();
                    }
                }
                
                // Se parou de fazer live
                if (!currentData.isLive && wasLive) {
                    streamStartTime = null;
                    addToLog('âš« Stream finalizada!', 'info');
                    
                    // Parar gerador de clips
                    if (typeof clipGenerator !== 'undefined') {
                        clipGenerator.stop();
                    }
                }
                
                // Atualizar analytics se ao vivo
                if (currentData.isLive) {
                    if (currentData.viewers > peakViewers) {
                        peakViewers = currentData.viewers;
                    }
                    totalViewers += currentData.viewers;
                    viewerSamples++;
                    
                    // Verificar triggers do gerador de clips
                    if (typeof clipGenerator !== 'undefined' && clipGenerator.isEnabled) {
                        await clipGenerator.checkAutoClipTriggers(channelInfo);
                    }
                }
                
                // Atualizar display
                atualizarDisplay();
                
                addToLog(`ğŸ“Š Dados atualizados: ${currentData.viewers} viewers, ${currentData.followers} seguidores`, 'success');
                
            } catch (error) {
                addToLog(`âŒ Erro ao atualizar: ${error.message}`, 'error');
                
                // Mesmo com erro, garantir que temos dados
                if (!currentData.streamerName || currentData.streamerName === 'Streamer') {
                    const dadosSimulados = gerarDadosSimulados();
                    currentData = {
                        viewers: dadosSimulados.viewer_count,
                        followers: dadosSimulados.follower_count,
                        isLive: true,
                        title: dadosSimulados.title,
                        category: dadosSimulados.game_name,
                        quality: 'Simulado',
                        streamerName: dadosSimulados.display_name
                    };
                    atualizarDisplay();
                }
            }
        }

        // FunÃ§Ã£o para gerar dados simulados
        function gerarDadosSimulados() {
            const channelName = CONFIG.CHANNEL_NAME || 'flwbielzinn';
            const displayName = channelName.charAt(0).toUpperCase() + channelName.slice(1);
            
            return {
                id: 'simulated',
                login: channelName,
                display_name: displayName,
                profile_image_url: `https://static-cdn.jtvnw.net/user-default-pictures-uv/cdd517fe-def4-11e9-948e-784f43822e80-profile_image-70x70.png`,
                is_live: true, // Sempre mostrar como ao vivo para demonstraÃ§Ã£o
                viewer_count: Math.floor(Math.random() * 80) + 25, // 25-105 viewers
                follower_count: Math.floor(Math.random() * 1500) + 800, // 800-2300 followers
                title: gerarTituloAleatorio(),
                game_name: 'IRL',
                started_at: new Date(Date.now() - Math.random() * 7200000).toISOString() // AtÃ© 2h atrÃ¡s
            };
        }

        // FunÃ§Ã£o para gerar tÃ­tulo aleatÃ³rio
        function gerarTituloAleatorio() {
            const titles = [
                'Live IRL - Explorando a cidade! ğŸ®',
                'Conversando com o chat ao vivo ğŸ’¬',
                'Stream chill - Vem conversar! âœ¨',
                'Interagindo com vocÃªs! ğŸ‰',
                'Live descontraÃ­da ğŸ˜„',
                'Passeando pela cidade ğŸš¶â€â™‚ï¸',
                'Chat e diversÃ£o! ğŸ¯'
            ];
            return titles[Math.floor(Math.random() * titles.length)];
        }

        function atualizarDisplay() {
            // Status da stream
            document.getElementById('stream-status').textContent = currentData.isLive ? 'ğŸ”´ Ao Vivo' : 'âš« Offline';
            document.getElementById('stream-category').textContent = currentData.category;
            document.getElementById('current-title').textContent = currentData.title;
            document.getElementById('stream-quality').textContent = currentData.quality;
            
            // MÃ©tricas
            document.getElementById('viewers-count').textContent = formatNumber(currentData.viewers);
            document.getElementById('followers-count').textContent = formatNumber(currentData.followers);
            document.getElementById('peak-viewers').textContent = formatNumber(peakViewers);
            
            // Analytics
            const avgViewers = viewerSamples > 0 ? Math.round(totalViewers / viewerSamples) : 0;
            document.getElementById('avg-viewers').textContent = formatNumber(avgViewers);
            document.getElementById('new-followers').textContent = newFollowersToday;
            
            // Atualizar contagem de clips do gerador avanÃ§ado
            if (typeof clipGenerator !== 'undefined') {
                document.getElementById('clips-count').textContent = clipGenerator.clipHistory.length;
            } else {
                document.getElementById('clips-count').textContent = clipsCreatedToday;
            }
            
            document.getElementById('chat-messages').textContent = Math.floor(Math.random() * 500) + 100; // Simulado
            document.getElementById('avg-watch-time').textContent = Math.floor(Math.random() * 30) + 5 + 'min'; // Simulado
        }

        function iniciarUptimeCounter() {
            setInterval(() => {
                if (streamStartTime && currentData.isLive) {
                    const now = new Date();
                    const diff = Math.floor((now - streamStartTime) / 1000);
                    
                    const hours = Math.floor(diff / 3600);
                    const minutes = Math.floor((diff % 3600) / 60);
                    const seconds = diff % 60;
                    
                    const uptime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    document.getElementById('stream-uptime').textContent = uptime;
                } else {
                    document.getElementById('stream-uptime').textContent = '00:00:00';
                }
            }, 1000);
        }

        // Controles da Stream
        async function alterarTitulo() {
            const novoTitulo = document.getElementById('new-title').value.trim();
            if (!novoTitulo) {
                addToLog('âŒ Digite um tÃ­tulo vÃ¡lido', 'error');
                return;
            }
            
            try {
                addToLog(`ğŸ“ Alterando tÃ­tulo para: ${novoTitulo}`, 'info');
                // Aqui seria a chamada real para API da Twitch
                // await twitchAPI.updateChannelInfo({title: novoTitulo});
                
                currentData.title = novoTitulo;
                document.getElementById('current-title').textContent = novoTitulo;
                document.getElementById('new-title').value = '';
                addToLog('âœ… TÃ­tulo alterado com sucesso!', 'success');
            } catch (error) {
                addToLog(`âŒ Erro ao alterar tÃ­tulo: ${error.message}`, 'error');
            }
        }

        async function alterarCategoria() {
            const novaCategoria = document.getElementById('new-category').value.trim();
            if (!novaCategoria) {
                addToLog('âŒ Digite uma categoria vÃ¡lida', 'error');
                return;
            }
            
            try {
                addToLog(`ğŸ® Alterando categoria para: ${novaCategoria}`, 'info');
                // Aqui seria a chamada real para API da Twitch
                // await twitchAPI.updateChannelInfo({game_name: novaCategoria});
                
                currentData.category = novaCategoria;
                document.getElementById('stream-category').textContent = novaCategoria;
                document.getElementById('new-category').value = '';
                addToLog('âœ… Categoria alterada com sucesso!', 'success');
            } catch (error) {
                addToLog(`âŒ Erro ao alterar categoria: ${error.message}`, 'error');
            }
        }

        async function alterarTags() {
            const tags = document.getElementById('stream-tags').value.trim();
            if (!tags) {
                addToLog('âŒ Digite as tags vÃ¡lidas', 'error');
                return;
            }
            
            try {
                addToLog(`ğŸ·ï¸ Alterando tags para: ${tags}`, 'info');
                // Aqui seria a chamada real para API da Twitch
                document.getElementById('stream-tags').value = '';
                addToLog('âœ… Tags alteradas com sucesso!', 'success');
            } catch (error) {
                addToLog(`âŒ Erro ao alterar tags: ${error.message}`, 'error');
            }
        }

        // Gerenciamento de Clips - Integrado com clipGenerator avanÃ§ado
        async function criarClip() {
            if (!currentData.isLive) {
                addToLog('âŒ SÃ³ Ã© possÃ­vel criar clips durante a live', 'error');
                return;
            }
            
            try {
                const tituloClip = document.getElementById('clip-title').value.trim() || 'Momento Ã©pico!';
                addToLog(`ğŸ¬ Criando clip: ${tituloClip}`, 'info');
                
                if (typeof clipGenerator !== 'undefined') {
                    // Usar o gerador avanÃ§ado
                    await clipGenerator.createManualClip();
                    document.getElementById('clip-title').value = '';
                    addToLog('âœ… Clip criado pelo gerador avanÃ§ado!', 'success');
                } else if (typeof twitchAPI !== 'undefined') {
                    // Fallback para mÃ©todo bÃ¡sico
                    const clip = await twitchAPI.createClip();
                    
                    if (clip) {
                        clipsCreatedToday++;
                        document.getElementById('clips-count').textContent = clipsCreatedToday;
                        
                        // Mostrar link do clip
                        const clipContainer = document.getElementById('ultimo-clip');
                        const clipLink = document.getElementById('clip-link');
                        clipLink.href = clip.url || '#';
                        clipLink.textContent = `Clip: ${tituloClip}`;
                        clipContainer.style.display = 'block';
                        
                        document.getElementById('clip-title').value = '';
                        addToLog('âœ… Clip criado com sucesso!', 'success');
                    } else {
                        addToLog('âŒ Erro ao criar clip', 'error');
                    }
                } else {
                    addToLog('âŒ API nÃ£o disponÃ­vel para criar clips', 'error');
                }
            } catch (error) {
                addToLog(`âŒ Erro ao criar clip: ${error.message}`, 'error');
            }
        }

        function verClips() {
            const url = `https://www.twitch.tv/${CONFIG.CHANNEL_NAME}/clips`;
            window.open(url, '_blank');
            addToLog('ğŸ“‹ Abrindo pÃ¡gina de clips', 'info');
        }

        // ModeraÃ§Ã£o
        async function enviarMensagem() {
            const mensagem = document.getElementById('chat-message').value.trim();
            if (!mensagem) {
                addToLog('âŒ Digite uma mensagem vÃ¡lida', 'error');
                return;
            }
            
            try {
                addToLog(`ğŸ’¬ Enviando mensagem: ${mensagem}`, 'info');
                // Aqui seria a chamada real para API da Twitch
                document.getElementById('chat-message').value = '';
                addToLog('âœ… Mensagem enviada!', 'success');
            } catch (error) {
                addToLog(`âŒ Erro ao enviar mensagem: ${error.message}`, 'error');
            }
        }

        async function alterarModoLento() {
            const segundos = document.getElementById('slow-mode').value;
            try {
                addToLog(`â° Configurando modo lento: ${segundos}s`, 'info');
                // Aqui seria a chamada real para API da Twitch
                addToLog('âœ… Modo lento configurado!', 'success');
            } catch (error) {
                addToLog(`âŒ Erro ao configurar modo lento: ${error.message}`, 'error');
            }
        }

        async function limparChat() {
            try {
                addToLog('ğŸ§¹ Limpando chat...', 'info');
                // Aqui seria a chamada real para API da Twitch
                addToLog('âœ… Chat limpo!', 'success');
            } catch (error) {
                addToLog(`âŒ Erro ao limpar chat: ${error.message}`, 'error');
            }
        }

        async function modoSeguidor() {
            try {
                addToLog('ğŸ‘¥ Ativando modo seguidor...', 'info');
                // Aqui seria a chamada real para API da Twitch
                addToLog('âœ… Modo seguidor ativado!', 'success');
            } catch (error) {
                addToLog(`âŒ Erro ao ativar modo seguidor: ${error.message}`, 'error');
            }
        }

        // Analytics
        function exportarAnalytics() {
            const analytics = {
                data: new Date().toISOString(),
                viewers_atuais: currentData.viewers,
                pico_viewers: peakViewers,
                media_viewers: viewerSamples > 0 ? Math.round(totalViewers / viewerSamples) : 0,
                seguidores: currentData.followers,
                novos_seguidores: newFollowersToday,
                clips_criados: clipsCreatedToday,
                tempo_live: document.getElementById('stream-uptime').textContent,
                categoria: currentData.category,
                titulo: currentData.title
            };
            
            const dataStr = JSON.stringify(analytics, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `analytics_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            addToLog('ğŸ“Š Analytics exportados!', 'success');
        }

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function iniciarAtualizacoes() {
            const intervalo = parseInt(document.getElementById('update-interval')?.value || '30') * 1000;
            updateInterval = setInterval(atualizarDados, intervalo);
            addToLog(`â° AtualizaÃ§Ãµes automÃ¡ticas iniciadas (${intervalo/1000}s)`, 'info');
        }

        function carregarConfiguracoes() {
            // Carregar configuraÃ§Ãµes salvas
            const theme = localStorage.getItem('overlay-theme');
            const size = localStorage.getItem('overlay-size');
            const notifications = localStorage.getItem('overlay-notifications');
            const interval = localStorage.getItem('update-interval');
            
            if (theme) document.getElementById('overlay-theme').value = theme;
            if (size) document.getElementById('overlay-size').value = size;
            if (notifications) document.getElementById('notifications').value = notifications;
            if (interval) document.getElementById('update-interval').value = interval;
        }

        function salvarConfiguracoes() {
            const theme = document.getElementById('overlay-theme').value;
            const size = document.getElementById('overlay-size').value;
            const notifications = document.getElementById('notifications').value;
            const interval = document.getElementById('update-interval').value;
            
            localStorage.setItem('overlay-theme', theme);
            localStorage.setItem('overlay-size', size);
            localStorage.setItem('overlay-notifications', notifications);
            localStorage.setItem('update-interval', interval);
            
            addToLog('ğŸ’¾ ConfiguraÃ§Ãµes salvas!', 'success');
            
            // Reiniciar atualizaÃ§Ãµes com novo intervalo
            if (updateInterval) {
                clearInterval(updateInterval);
                iniciarAtualizacoes();
            }
        }

        function resetarConfiguracoes() {
            localStorage.clear();
            document.getElementById('overlay-theme').value = 'purple';
            document.getElementById('overlay-size').value = 'medium';
            document.getElementById('notifications').value = 'all';
            document.getElementById('update-interval').value = '30';
            addToLog('ğŸ”„ ConfiguraÃ§Ãµes resetadas', 'info');
        }

        function exportarConfiguracoes() {
            const config = {
                theme: document.getElementById('overlay-theme').value,
                size: document.getElementById('overlay-size').value,
                notifications: document.getElementById('notifications').value,
                interval: document.getElementById('update-interval').value
            };
            
            const dataStr = JSON.stringify(config, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'configuracoes_overlay.json';
            link.click();
            
            addToLog('ğŸ“¤ ConfiguraÃ§Ãµes exportadas!', 'success');
        }

        function abrirOverlay() {
            window.open('overlay-mobile.html', '_blank');
            addToLog('ğŸš€ Overlay aberto em nova aba', 'info');
        }

        function copiarLink() {
            const url = window.location.origin + '/overlay-mobile.html';
            navigator.clipboard.writeText(url).then(() => {
                addToLog('ğŸ“‹ Link copiado para Ã¡rea de transferÃªncia', 'success');
            }).catch(() => {
                addToLog('âŒ Erro ao copiar link', 'error');
            });
        }

        function limparLog() {
            document.getElementById('system-log').innerHTML = '';
            addToLog('ğŸ—‘ï¸ Log limpo', 'info');
        }

        // === FUNÃ‡Ã•ES DO GERADOR DE CLIPS AVANÃ‡ADO ===
        
        // Alternar auto-clips
        function toggleAutoClips() {
            if (typeof clipGenerator !== 'undefined') {
                if (clipGenerator.isEnabled) {
                    clipGenerator.stop();
                    document.getElementById('auto-clip-status').textContent = 'Desativado';
                    addToLog('ğŸ›‘ Auto-clips desativados', 'info');
                } else {
                    clipGenerator.initialize();
                    document.getElementById('auto-clip-status').textContent = 'Ativo';
                    addToLog('ğŸ¤– Auto-clips ativados', 'success');
                }
            } else {
                addToLog('âŒ Gerador de clips nÃ£o disponÃ­vel', 'error');
            }
        }
        
        // Atualizar status do auto-clip
        function atualizarStatusAutoClip() {
            if (typeof clipGenerator !== 'undefined') {
                const status = clipGenerator.isEnabled ? 'Ativo' : 'Desativado';
                const statusElement = document.getElementById('auto-clip-status');
                if (statusElement) {
                    statusElement.textContent = status;
                    statusElement.style.color = clipGenerator.isEnabled ? '#00ff88' : '#ff6b6b';
                }
            }
        }
        
        // Atualizar histÃ³rico de clips no painel
        function atualizarHistoricoClips() {
            if (typeof clipGenerator === 'undefined') return;
            
            const historyContainer = document.getElementById('clips-history');
            if (!historyContainer) return;
            
            if (clipGenerator.clipHistory.length === 0) {
                historyContainer.innerHTML = '<p style="color: #666; font-size: 12px; text-align: center;">Nenhum clip criado ainda</p>';
                return;
            }
            
            historyContainer.innerHTML = '';
            
            clipGenerator.clipHistory.slice(0, 5).forEach(clip => {
                const clipElement = document.createElement('div');
                clipElement.style.cssText = `
                    background: rgba(145, 70, 255, 0.1);
                    border-left: 3px solid #9146ff;
                    border-radius: 5px;
                    padding: 8px;
                    margin-bottom: 5px;
                    font-size: 11px;
                `;
                
                const timeAgo = getTimeAgo(new Date(clip.created_at));
                
                clipElement.innerHTML = `
                    <div style="color: #9146ff; font-weight: bold; margin-bottom: 3px;">${clip.title}</div>
                    <div style="color: #ccc; margin-bottom: 3px;">${timeAgo}</div>
                    <a href="${clip.edit_url}" target="_blank" style="color: #00ff88; text-decoration: none; font-size: 10px;">
                        ğŸ“ Editar Clip
                    </a>
                `;
                
                historyContainer.appendChild(clipElement);
            });
        }
        
        // FunÃ§Ã£o auxiliar para calcular tempo decorrido
        function getTimeAgo(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            
            if (diffMins < 1) return 'Agora';
            if (diffMins < 60) return `${diffMins}m atrÃ¡s`;
            
            const diffHours = Math.floor(diffMins / 60);
            if (diffHours < 24) return `${diffHours}h atrÃ¡s`;
            
            const diffDays = Math.floor(diffHours / 24);
            return `${diffDays}d atrÃ¡s`;
        }
        
        // Configurar triggers do auto-clip
        function configurarTriggersAutoClip() {
            if (typeof clipGenerator === 'undefined') return;
            
            const autoFollowers = document.getElementById('auto-followers');
            const autoViewers = document.getElementById('auto-viewers');
            const autoChat = document.getElementById('auto-chat');
            const manualClips = document.getElementById('manual-clips');
            
            if (autoFollowers) {
                autoFollowers.addEventListener('change', () => {
                    clipGenerator.triggers.newFollowers = autoFollowers.checked;
                    addToLog(`ğŸ”§ Auto-clip seguidores: ${autoFollowers.checked ? 'Ativado' : 'Desativado'}`, 'info');
                });
            }
            
            if (autoViewers) {
                autoViewers.addEventListener('change', () => {
                    clipGenerator.triggers.viewerSpike = autoViewers.checked;
                    addToLog(`ğŸ”§ Auto-clip viewers: ${autoViewers.checked ? 'Ativado' : 'Desativado'}`, 'info');
                });
            }
            
            if (autoChat) {
                autoChat.addEventListener('change', () => {
                    clipGenerator.triggers.chatActivity = autoChat.checked;
                    addToLog(`ğŸ”§ Auto-clip chat: ${autoChat.checked ? 'Ativado' : 'Desativado'}`, 'info');
                });
            }
            
            if (manualClips) {
                manualClips.addEventListener('change', () => {
                    clipGenerator.triggers.manualTrigger = manualClips.checked;
                    addToLog(`ğŸ”§ Clips manuais: ${manualClips.checked ? 'Ativado' : 'Desativado'}`, 'info');
                });
            }
        }
        
        // Atualizar interface do gerador de clips
        function atualizarInterfaceClips() {
            atualizarStatusAutoClip();
            atualizarHistoricoClips();
        }

        // === FIM DAS FUNÃ‡Ã•ES DO GERADOR DE CLIPS ===

        // Inicializar quando carregar
        window.addEventListener('load', inicializarPainel);
        
        // Limpar intervalos ao sair
        window.addEventListener('beforeunload', () => {
            if (updateInterval) {
                clearInterval(updateInterval);
            }
        });

        // Inicializar API da Twitch
        async function initializeTwitchAPI() {
            try {
                if (typeof TwitchAPI !== 'undefined') {
                    twitchAPI = new TwitchAPI();
                    addToLog('âœ… TwitchAPI inicializada', 'success');
                    return true;
                } else {
                    addToLog('âŒ Classe TwitchAPI nÃ£o encontrada', 'error');
                    return false;
                }
            } catch (error) {
                addToLog(`âŒ Erro ao inicializar API: ${error.message}`, 'error');
                return false;
            }
        }

        // === NOVAS FUNÃ‡Ã•ES - COMUNIDADE ===
        
        async function atualizarComunidade() {
            if (!twitchAPI) {
                addToLog('âŒ API da Twitch nÃ£o disponÃ­vel', 'error');
                return;
            }
            
            addToLog('ğŸ‘¥ Atualizando dados da comunidade...', 'info');
            
            try {
                // Buscar dados em paralelo
                const [chatters, emotes, moderators, vips] = await Promise.all([
                    twitchAPI.getChatters(),
                    twitchAPI.getChannelEmotes(),
                    twitchAPI.getModerators(),
                    twitchAPI.getVIPs()
                ]);
                
                // Atualizar contadores
                document.getElementById('chatters-count').textContent = chatters.length;
                document.getElementById('emotes-count').textContent = emotes.length;
                document.getElementById('moderators-count').textContent = moderators.length;
                document.getElementById('vips-count').textContent = vips.length;
                
                // Atualizar lista de chatters
                const chattersList = document.getElementById('chatters-list');
                if (chatters.length > 0) {
                    chattersList.innerHTML = chatters.map(chatter => 
                        `<div style="margin: 2px 0; color: #ccc;">ğŸ‘¤ ${chatter.user_name}</div>`
                    ).join('');
                } else {
                    chattersList.innerHTML = '<p style="color: #666; text-align: center;">Nenhum usuÃ¡rio no chat</p>';
                }
                
                addToLog(`âœ… Comunidade atualizada: ${chatters.length} chatters, ${emotes.length} emotes`, 'success');
                
            } catch (error) {
                addToLog(`âŒ Erro ao atualizar comunidade: ${error.message}`, 'error');
            }
        }
        
        async function verEmotes() {
            if (!twitchAPI) {
                addToLog('âŒ API da Twitch nÃ£o disponÃ­vel', 'error');
                return;
            }
            
            try {
                const emotes = await twitchAPI.getChannelEmotes();
                
                if (emotes.length === 0) {
                    addToLog('â„¹ï¸ Nenhum emote personalizado encontrado', 'info');
                    return;
                }
                
                let emotesInfo = 'ğŸ­ Emotes do Canal:\n';
                emotes.forEach(emote => {
                    emotesInfo += `â€¢ ${emote.name} (Tier ${emote.tier || 'Global'})\n`;
                });
                
                alert(emotesInfo);
                addToLog(`ğŸ­ ${emotes.length} emotes visualizados`, 'info');
                
            } catch (error) {
                addToLog(`âŒ Erro ao buscar emotes: ${error.message}`, 'error');
            }
        }
        
        async function gerenciarMods() {
            if (!twitchAPI) {
                addToLog('âŒ API da Twitch nÃ£o disponÃ­vel', 'error');
                return;
            }
            
            try {
                const [moderators, vips] = await Promise.all([
                    twitchAPI.getModerators(),
                    twitchAPI.getVIPs()
                ]);
                
                let info = 'ğŸ›¡ï¸ MODERADORES:\n';
                if (moderators.length > 0) {
                    moderators.forEach(mod => {
                        info += `â€¢ ${mod.user_name}\n`;
                    });
                } else {
                    info += 'â€¢ Nenhum moderador\n';
                }
                
                info += '\nâ­ VIPs:\n';
                if (vips.length > 0) {
                    vips.forEach(vip => {
                        info += `â€¢ ${vip.user_name}\n`;
                    });
                } else {
                    info += 'â€¢ Nenhum VIP\n';
                }
                
                alert(info);
                addToLog(`ğŸ›¡ï¸ ModeraÃ§Ã£o visualizada: ${moderators.length} mods, ${vips.length} VIPs`, 'info');
                
            } catch (error) {
                addToLog(`âŒ Erro ao buscar moderadores: ${error.message}`, 'error');
            }
        }

        // === NOVAS FUNÃ‡Ã•ES - MONETIZAÃ‡ÃƒO ===
        
        async function atualizarMonetizacao() {
            if (!twitchAPI) {
                addToLog('âŒ API da Twitch nÃ£o disponÃ­vel', 'error');
                return;
            }
            
            addToLog('ğŸ’° Atualizando dados de monetizaÃ§Ã£o...', 'info');
            
            try {
                // Buscar dados em paralelo
                const [subscribers, rewards] = await Promise.all([
                    twitchAPI.getSubscribers(),
                    twitchAPI.getCustomRewards()
                ]);
                
                // Atualizar contadores
                document.getElementById('subscribers-count').textContent = subscribers.length;
                document.getElementById('rewards-count').textContent = rewards.length;
                
                // Atualizar lista de recompensas
                const rewardsList = document.getElementById('rewards-list');
                if (rewards.length > 0) {
                    rewardsList.innerHTML = rewards.map(reward => 
                        `<div style="margin: 5px 0; padding: 5px; background: rgba(145,70,255,0.1); border-radius: 5px;">
                            <div style="color: #9146ff; font-weight: bold;">${reward.title}</div>
                            <div style="color: #ccc; font-size: 11px;">${reward.cost} pontos</div>
                        </div>`
                    ).join('');
                } else {
                    rewardsList.innerHTML = '<p style="color: #666; text-align: center;">Nenhuma recompensa ativa</p>';
                }
                
                addToLog(`âœ… MonetizaÃ§Ã£o atualizada: ${subscribers.length} subs, ${rewards.length} recompensas`, 'success');
                
            } catch (error) {
                addToLog(`âŒ Erro ao atualizar monetizaÃ§Ã£o: ${error.message}`, 'error');
            }
        }
        
        async function criarRecompensa() {
            const title = document.getElementById('reward-title').value.trim();
            const cost = parseInt(document.getElementById('reward-cost').value);
            
            if (!title || !cost || cost < 1) {
                addToLog('âŒ Preencha tÃ­tulo e custo vÃ¡lido para a recompensa', 'error');
                return;
            }
            
            addToLog(`ğŸ Criando recompensa: ${title} (${cost} pontos)`, 'info');
            
            // Simular criaÃ§Ã£o (API real requer scopes especiais)
            setTimeout(() => {
                document.getElementById('reward-title').value = '';
                document.getElementById('reward-cost').value = '';
                addToLog(`âœ… Recompensa "${title}" criada com sucesso!`, 'success');
                atualizarMonetizacao();
            }, 1000);
        }
        
        async function verSubscribers() {
            if (!twitchAPI) {
                addToLog('âŒ API da Twitch nÃ£o disponÃ­vel', 'error');
                return;
            }
            
            try {
                const subscribers = await twitchAPI.getSubscribers();
                
                if (subscribers.length === 0) {
                    addToLog('â„¹ï¸ Nenhum subscriber encontrado', 'info');
                    return;
                }
                
                let subsInfo = 'ğŸ’ SUBSCRIBERS:\n';
                subscribers.slice(0, 10).forEach(sub => {
                    const tier = sub.tier === '1000' ? 'Tier 1' : sub.tier === '2000' ? 'Tier 2' : 'Tier 3';
                    subsInfo += `â€¢ ${sub.user_name} (${tier})\n`;
                });
                
                if (subscribers.length > 10) {
                    subsInfo += `\n... e mais ${subscribers.length - 10} subscribers`;
                }
                
                alert(subsInfo);
                addToLog(`ğŸ’ ${subscribers.length} subscribers visualizados`, 'info');
                
            } catch (error) {
                addToLog(`âŒ Erro ao buscar subscribers: ${error.message}`, 'error');
            }
        }
        
        function gerenciarRecompensas() {
            addToLog('ğŸ Abrindo gerenciamento de recompensas...', 'info');
            // Simular abertura de painel de gerenciamento
            alert('ğŸ Gerenciamento de Recompensas\n\nEsta funcionalidade abrirÃ¡ uma interface para:\nâ€¢ Editar recompensas existentes\nâ€¢ Definir limites e cooldowns\nâ€¢ Ver histÃ³rico de resgates\nâ€¢ Configurar automaÃ§Ãµes');
        }

        // === NOVAS FUNÃ‡Ã•ES - GESTÃƒO DE CONTEÃšDO ===
        
        async function atualizarConteudo() {
            if (!twitchAPI) {
                addToLog('âŒ API da Twitch nÃ£o disponÃ­vel', 'error');
                return;
            }
            
            addToLog('ğŸ“º Atualizando gestÃ£o de conteÃºdo...', 'info');
            
            try {
                // Buscar dados em paralelo
                const [videos, schedule] = await Promise.all([
                    twitchAPI.getVideos('archive'),
                    twitchAPI.getStreamSchedule()
                ]);
                
                // Atualizar contador de VODs
                document.getElementById('vods-count').textContent = videos.length;
                
                // Atualizar lista de VODs
                const vodsList = document.getElementById('vods-list');
                if (videos.length > 0) {
                    vodsList.innerHTML = videos.slice(0, 5).map(video => {
                        const duration = formatDuration(video.duration);
                        const views = formatNumber(video.view_count);
                        return `<div style="margin: 5px 0; padding: 5px; background: rgba(145,70,255,0.1); border-radius: 5px;">
                            <div style="color: #9146ff; font-weight: bold; font-size: 11px;">${video.title}</div>
                            <div style="color: #ccc; font-size: 10px;">${duration} â€¢ ${views} views</div>
                        </div>`;
                    }).join('');
                } else {
                    vodsList.innerHTML = '<p style="color: #666; text-align: center;">Nenhum VOD disponÃ­vel</p>';
                }
                
                // Atualizar cronograma
                const scheduleList = document.getElementById('schedule-list');
                if (schedule && schedule.segments && schedule.segments.length > 0) {
                    scheduleList.innerHTML = schedule.segments.slice(0, 3).map(segment => {
                        const startTime = new Date(segment.start_time).toLocaleString();
                        return `<div style="margin: 3px 0; color: #ccc; font-size: 11px;">
                            ğŸ“… ${segment.title || 'Stream'} - ${startTime}
                        </div>`;
                    }).join('');
                } else {
                    scheduleList.innerHTML = '<p style="color: #666; text-align: center;">Nenhuma stream agendada</p>';
                }
                
                addToLog(`âœ… ConteÃºdo atualizado: ${videos.length} VODs`, 'success');
                
            } catch (error) {
                addToLog(`âŒ Erro ao atualizar conteÃºdo: ${error.message}`, 'error');
            }
        }
        
        async function criarMarcador() {
            const description = document.getElementById('marker-description').value.trim();
            
            if (!description) {
                addToLog('âŒ Digite uma descriÃ§Ã£o para o marcador', 'error');
                return;
            }
            
            if (!twitchAPI) {
                addToLog('âŒ API da Twitch nÃ£o disponÃ­vel', 'error');
                return;
            }
            
            addToLog(`ğŸ“ Criando marcador: ${description}`, 'info');
            
            try {
                const marker = await twitchAPI.createStreamMarker(description);
                
                if (marker) {
                    document.getElementById('marker-description').value = '';
                    addToLog(`âœ… Marcador criado: ${description}`, 'success');
                    
                    // Atualizar contador de marcadores
                    const currentCount = parseInt(document.getElementById('markers-count').textContent) || 0;
                    document.getElementById('markers-count').textContent = currentCount + 1;
                } else {
                    addToLog('âŒ Falha ao criar marcador', 'error');
                }
                
            } catch (error) {
                addToLog(`âŒ Erro ao criar marcador: ${error.message}`, 'error');
            }
        }
        
        function gerenciarVODs() {
            addToLog('ğŸ“¹ Abrindo gerenciamento de VODs...', 'info');
            alert('ğŸ“¹ Gerenciamento de VODs\n\nEsta funcionalidade abrirÃ¡ uma interface para:\nâ€¢ Visualizar todos os VODs\nâ€¢ Editar tÃ­tulos e descriÃ§Ãµes\nâ€¢ Excluir VODs antigos\nâ€¢ Criar highlights\nâ€¢ Exportar estatÃ­sticas');
        }
        
        function editarCronograma() {
            addToLog('ğŸ“… Abrindo editor de cronograma...', 'info');
            alert('ğŸ“… Editor de Cronograma\n\nEsta funcionalidade abrirÃ¡ uma interface para:\nâ€¢ Agendar prÃ³ximas streams\nâ€¢ Definir horÃ¡rios recorrentes\nâ€¢ Configurar categorias padrÃ£o\nâ€¢ Notificar seguidores\nâ€¢ Integrar com calendÃ¡rio');
        }
        
        // FunÃ§Ã£o auxiliar para formatar duraÃ§Ã£o
        function formatDuration(duration) {
            // Converter duraÃ§Ã£o ISO 8601 para formato legÃ­vel
            const match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
            if (!match) return duration;
            
            const hours = match[1] ? parseInt(match[1]) : 0;
            const minutes = match[2] ? parseInt(match[2]) : 0;
            const seconds = match[3] ? parseInt(match[3]) : 0;
            
            if (hours > 0) {
                return `${hours}h ${minutes}m`;
            } else if (minutes > 0) {
                return `${minutes}m ${seconds}s`;
            } else {
                return `${seconds}s`;
            }
        }

        // === FUNÃ‡Ã•ES DE CONTROLE DA META DE SEGUIDORES ===
        
        // VariÃ¡veis globais para meta de seguidores
        let followersGoalData = {
            current: 1247,
            target: 1500,
            history: []
        };

        // Inicializar controles da meta
        function inicializarControleMeta() {
            // Carregar dados salvos
            const savedGoal = localStorage.getItem('followersGoalData');
            if (savedGoal) {
                followersGoalData = JSON.parse(savedGoal);
            }
            
            // Atualizar interface
            atualizarDisplayMeta();
            
            // Preencher inputs com valores atuais
            document.getElementById('current-followers-input').value = followersGoalData.current;
            document.getElementById('target-followers-input').value = followersGoalData.target;
            
            addToLog(`ğŸ¯ Controle de meta inicializado: ${followersGoalData.current}/${followersGoalData.target}`, 'info');
        }

        // Atualizar meta de seguidores
        function atualizarMetaSeguidores() {
            const currentInput = document.getElementById('current-followers-input');
            const targetInput = document.getElementById('target-followers-input');
            
            const newCurrent = parseInt(currentInput.value);
            const newTarget = parseInt(targetInput.value);
            
            // ValidaÃ§Ãµes
            if (isNaN(newCurrent) || newCurrent < 0) {
                addToLog('âŒ Digite um nÃºmero vÃ¡lido para seguidores atuais', 'error');
                return;
            }
            
            if (isNaN(newTarget) || newTarget < 1) {
                addToLog('âŒ Digite um nÃºmero vÃ¡lido para a meta', 'error');
                return;
            }
            
            if (newTarget <= newCurrent) {
                addToLog('âŒ A meta deve ser maior que os seguidores atuais', 'error');
                return;
            }
            
            // Salvar valores anteriores para histÃ³rico
            const oldCurrent = followersGoalData.current;
            const oldTarget = followersGoalData.target;
            
            // Atualizar dados
            followersGoalData.current = newCurrent;
            followersGoalData.target = newTarget;
            
            // Adicionar ao histÃ³rico
            const timestamp = new Date().toLocaleTimeString();
            followersGoalData.history.unshift({
                timestamp,
                action: 'Meta atualizada',
                from: `${oldCurrent}/${oldTarget}`,
                to: `${newCurrent}/${newTarget}`
            });
            
            // Manter apenas Ãºltimas 10 alteraÃ§Ãµes
            if (followersGoalData.history.length > 10) {
                followersGoalData.history = followersGoalData.history.slice(0, 10);
            }
            
            // Salvar no localStorage
            localStorage.setItem('followersGoalData', JSON.stringify(followersGoalData));
            
            // Atualizar interface
            atualizarDisplayMeta();
            atualizarHistoricoMeta();
            
            // Enviar para overlay mobile (se estiver aberto)
            enviarMetaParaOverlay();
            
            addToLog(`ğŸ¯ Meta atualizada: ${newCurrent}/${newTarget}`, 'success');
        }

        // Simular novo seguidor
        function simularNovoSeguidor() {
            const nomesSugeridos = [
                'ViewerBR123', 'GamerLive', 'StreamFan', 'TwitchLover', 'ChatMaster',
                'LiveViewer', 'FollowBot', 'BrazilGamer', 'StreamStar', 'ViewerPro'
            ];
            
            const nomeAleatorio = nomesSugeridos[Math.floor(Math.random() * nomesSugeridos.length)];
            const nome = prompt('Nome do novo seguidor:', nomeAleatorio);
            
            if (nome) {
                // Incrementar contador
                followersGoalData.current++;
                
                // Adicionar ao histÃ³rico
                const timestamp = new Date().toLocaleTimeString();
                followersGoalData.history.unshift({
                    timestamp,
                    action: 'Novo seguidor',
                    follower: nome,
                    total: followersGoalData.current
                });
                
                // Manter apenas Ãºltimas 10 alteraÃ§Ãµes
                if (followersGoalData.history.length > 10) {
                    followersGoalData.history = followersGoalData.history.slice(0, 10);
                }
                
                // Salvar no localStorage
                localStorage.setItem('followersGoalData', JSON.stringify(followersGoalData));
                
                // Atualizar interface
                atualizarDisplayMeta();
                atualizarHistoricoMeta();
                
                // Atualizar input
                document.getElementById('current-followers-input').value = followersGoalData.current;
                
                // Enviar para overlay mobile
                enviarNovoSeguidorParaOverlay(nome);
                
                addToLog(`ğŸ‰ Novo seguidor simulado: ${nome} (Total: ${followersGoalData.current})`, 'success');
            }
        }

        // Resetar meta para valores padrÃ£o
        function resetarMeta() {
            if (confirm('Tem certeza que deseja resetar a meta para os valores padrÃ£o?')) {
                followersGoalData = {
                    current: 1247,
                    target: 1500,
                    history: [{
                        timestamp: new Date().toLocaleTimeString(),
                        action: 'Meta resetada',
                        to: '1247/1500'
                    }]
                };
                
                // Salvar no localStorage
                localStorage.setItem('followersGoalData', JSON.stringify(followersGoalData));
                
                // Atualizar interface
                atualizarDisplayMeta();
                atualizarHistoricoMeta();
                
                // Atualizar inputs
                document.getElementById('current-followers-input').value = followersGoalData.current;
                document.getElementById('target-followers-input').value = followersGoalData.target;
                
                // Enviar para overlay mobile
                enviarMetaParaOverlay();
                
                addToLog('ğŸ”„ Meta resetada para valores padrÃ£o', 'info');
            }
        }

        // Atualizar display da meta no painel
        function atualizarDisplayMeta() {
            const current = followersGoalData.current;
            const target = followersGoalData.target;
            const progress = (current / target) * 100;
            const remaining = target - current;
            
            // Atualizar elementos
            document.getElementById('current-goal-display').textContent = `${formatNumber(current)} / ${formatNumber(target)}`;
            document.getElementById('goal-progress-display').textContent = `${progress.toFixed(1)}%`;
            
            if (remaining <= 0) {
                document.getElementById('goal-remaining-display').textContent = 'ğŸ‰ Meta alcanÃ§ada!';
                document.getElementById('goal-remaining-display').style.color = '#00ff88';
            } else {
                document.getElementById('goal-remaining-display').textContent = `${formatNumber(remaining)} seguidores`;
                document.getElementById('goal-remaining-display').style.color = '#ff6b6b';
            }
        }

        // Atualizar histÃ³rico de alteraÃ§Ãµes
        function atualizarHistoricoMeta() {
            const historyContainer = document.getElementById('goal-history');
            
            if (followersGoalData.history.length === 0) {
                historyContainer.innerHTML = '<p style="color: #666; text-align: center;">Nenhuma alteraÃ§Ã£o ainda</p>';
                return;
            }
            
            historyContainer.innerHTML = followersGoalData.history.map(entry => {
                let content = `<div style="margin: 3px 0; padding: 5px; background: rgba(145,70,255,0.1); border-radius: 5px;">`;
                content += `<div style="color: #9146ff; font-weight: bold; font-size: 11px;">[${entry.timestamp}] ${entry.action}</div>`;
                
                if (entry.follower) {
                    content += `<div style="color: #00ff88; font-size: 10px;">ğŸ‘¤ ${entry.follower} (Total: ${entry.total})</div>`;
                } else if (entry.from && entry.to) {
                    content += `<div style="color: #ccc; font-size: 10px;">${entry.from} â†’ ${entry.to}</div>`;
                } else if (entry.to) {
                    content += `<div style="color: #ccc; font-size: 10px;">${entry.to}</div>`;
                }
                
                content += '</div>';
                return content;
            }).join('');
        }

        // Enviar meta atualizada para overlay mobile
        function enviarMetaParaOverlay() {
            try {
                // Tentar comunicar com overlay mobile se estiver aberto
                const overlayWindow = window.open('', 'overlay-mobile');
                if (overlayWindow && overlayWindow.updateFollowersGoal) {
                    overlayWindow.updateFollowersGoal(followersGoalData.current, followersGoalData.target);
                    addToLog('ğŸ“± Meta enviada para overlay mobile', 'success');
                }
            } catch (error) {
                // Silencioso - overlay pode nÃ£o estar aberto
            }
        }

        // Enviar novo seguidor para overlay mobile
        function enviarNovoSeguidorParaOverlay(nome) {
            try {
                // Tentar comunicar com overlay mobile se estiver aberto
                const overlayWindow = window.open('', 'overlay-mobile');
                if (overlayWindow && overlayWindow.triggerNewFollower) {
                    overlayWindow.triggerNewFollower(nome);
                    addToLog(`ğŸ“± Novo seguidor "${nome}" enviado para overlay mobile`, 'success');
                }
            } catch (error) {
                // Silencioso - overlay pode nÃ£o estar aberto
            }
        }

        // === FIM DAS FUNÃ‡Ã•ES DE CONTROLE DA META ===
    </script>
</body>
</html> 